<hr />

# WebProxy

## 프록시(Porxy)란?
지금 설명하는 프록시는 인터넷상의 프록시를 의미한다.

```
<프록시서버가 없는 통신>
+--------+              +----------+
| Client |    <----->   | Internet |
+--------+              +----------+

<프록시 서버가 있는 통신>
+--------+              +--------------+              +----------+
| Client |    <----->   | Proxy Server |    <----->   | Internet |
+--------+              +--------------+              +----------+
```

> 클라이언트와 서버 사이에서 **`중개자 역할을 수행하는 서버`** 로, 프록시 서버(Proxy Server)라고도 부른다.<br>
> 프록시서버는 클라이언트가 서버에 직접 접속하는 대신 프록시를 통해 요청을 보내고, 서버에서 응답이 오면 다시 프록시가 이를 클라이언트에게 전달한다.<br>
> 이를 통하여 보안, 성능, 익명성, 디버깅, 트래픽 모니터링등 다양한 목적을 달성한다.

---

## 프록시의 특징
- **보안 및 프라이버시 보호:** 실제 사용자의 IP주소를 숨겨 개인정보를 보호하고, 외부로부터의 직접적인 접근을 차단하여 내부 네트워크를 안전하게 유지
- **접근 제어 및 콘텐츠 필터링:** 특정 웹사이트에 대한 접근을 제한하거나, 유해한 콘텐츠를 차단하여 네트워크 사용을 관리 및 통제
- **캐시를 통한 속도 향상:** 자주 방문하는 웹사이트의 데이터를 프록시 서버에 저장하여, 이후 동일한 욫어 시 빠르게 응답함으로 인터넷 속도를 향상
---

## 프록시 유형

```
<포워드 프록시(Forward Proxy)>
+----------------LAN-------------------------+
|  +--------+                                |                                          +----------+
|  | Client |  <------+                      |                               /--------> |  Server  |
|  +--------+		  |                      |                              /           +----------+
|                     |                      |                             /
|  +--------+         |    +--------------+  |           +----------+     /
|  | Client |  <------+->  | ForwardProxy | <----------> | Internet | <--+
|  +--------+         |    +--------------+  |           +----------+     \
|                     |                      |                             \
|  +--------+         |                      |                              \           +----------+
|  | Client |  <------+                      |                               \--------> |  Server  |
|  +--------+                                |                                          +----------+
+--------------------------------------------+

<리버스 프록시(Reverse Proxy)>
                                                +------------------LAN--------------------------------+
+--------+                                      |                                      +----------+   |
| Client |  <------+                            |   NGINX                   /--------> |  Server  |   |
+--------+         |                            |                          /           +----------+   |
                   |                            |                         /                           |
+--------+         |    +------------+          |   +--------------+     /                            |
| Client |  <------+->  |  Internet  | <--------+-> | ReverseProxy | <--+                             |
+--------+         |    +------------+          |   +--------------+     \                            |
                   |                            |                         \                           |
+--------+         |                            |                          \            +----------+  |
| Client |  <------+                            |                           \-------->  |  Server  |  |
+--------+                                      |                                       +----------+  |
                                                +-----------------------------------------------------+
```

1. **`포워드 프록시(Forward Proxy)` :** 클라이언트와 외부 서버 사이에 위치하여, 클라이언트의 요청을 대신 전달하고 서버로부터 응답을 받아 사용자에게 전달하고 사용자의 IP 주소를 숨기거나, 특정 웹사이트에 대한 접근을 우회하는 데 사용 **`(클라이언트의 프록시)`**

2. **`리버스 프록시(Reverse Proxy)` :** 서버 측에 위치하여, 외부 클라이언트의 요청을 받아 내부 서버에 전달하고, 그 응답을 클라이언트에게 전달하고 서버의 부하를 분산시키고, 보안을 강화하며, 내부 서버의 구조를 외부에 노출하지 않도록 하는 데 사용 **`(서버의 프록시)`**

#### 포워드 프록시와 리버스 프록시 차이점

구분 | 엔드포인트(End-Point) | 무엇을 감추는가 | 주요 목적 | 사용 예시
|--|--|--|--|--|
포워드 프록시 | 실제 서버 | 클라이언트(사용자) | 사용자 익명성, 접근 통제 | 사내 인터넷 접근 통제, 지역 제한 우회
리버스 프록시 | 리버스 프록시 서버 | 서버(웹 서버) | 서버 보호, 부하 분산 | 웹 서버 보안 강화, 로드 밸런싱

## 프록시 활용 예시
```css
[External Network] 
    ↓ 
[Firewall] 
    ↓ 
[DMZ: Load Balancer] → [웹서버1, 웹서버2, 메일서버, DNS서버]
    ↓
[Firewall]
    ↓
[Internal Network: WAS, DBMS]
```
### **`DMZ(Demilitarized Zone)`**
DMZ는 **내부 네트워크(Internal Network)** 와 **외부 네트워크(External Network)** 사이에 위치한 **중간네트워크** 영역<br>
DMZ는 보안 강화하기 위해 설게된 영역으로, 해당 네트워크에 위치한 서버는 보통 외부와 내부를 **동시에 연결하는 역할**을 함<br>

1. DMZ의 기본 역할
- 내부망을 외부로부터 직접적으로 노출시키지 않음.
- 외부망(예: 인터넷)으로부터 들어오는 요청이나 내부망의 리소스로 접근하려는 요청을 **중간 단계에서 필터링하거나, 중계**함.
- DMZ에 배치된 서버는 적절한 보안 정책을 통해, 내부망의 중요한 시스템을 보호하는 방패 역할을 함.

2. DMZ에서 포워드 프록시와 리버스 프록시가 가능
DMZ는 보안과 네트워크 관리 목적으로 설계된 공간으로, 내부망과 외부망 간 **중재 역할**을 합니다. 이렇게 중간 단계에 위치하기 때문에, **둘 다(포워드 프록시와 리버스 프록시)** 구현 가능<br>

    (1). DMZ에서 포워드 프록시 역할
    - **DMZ에 포워드 프록시** 를 배치하게 되면, 내부망 사용자(클라이언트)가 외부망으로 트래픽을 보낼 때 한 번 거쳐 가는 경유지 역할 수행
    - 내부 사용자가 직접 외부망에 접근하지 않고, 포워드 프록시가 대신 요청을 처리하기 때문에 내부망이 보호
    - 주로 회사 내부에서 사용자가 외부 인터넷이나 서비스에 연결하려는 경우, 익명 접속, 캐싱 서비스, 또는 접근 제어 등을 제공하기 위해 사용

    (2). DMZ에서 리버스 프록시 역할
    - **DMZ에 리버스 프록시를 배치**하면, 외부 클라이언트(예: 일반 사용자, 고객 등)가 내부망 서버에 요청을 보낼 때 **DMZ의 리버스 프록시가 내부망 서버를 대신해서 요청을 처리**
    - 외부 사용자는 **리버스 프록시**만 보게 되며, 직접적으로 내부 서버(WAS, DB 등)에 접근할 수 없게 만들어 보안을 강화
    - 이 방식을 통해 로드밸런싱, 보안 강화, SSL 해제(terminate)와 같은 기능을 제공

3. **구성:** 외부망(External Network) ↔ **방화벽** ↔ **DMZ** ↔ **방화벽** ↔ 내부망(Internal Network)
    - **DMZ 배치하는 서버:**
        - **웹서버:** 외부 클라이언트 요청을 받아 내부망의 WAS로 전달.
        - **메일 서버:** 메일 송수신 처리(예: 외부 이메일과의 연동)
        - **DNS 서버:** 내부망의 네트워크 구성 정보를 외부 클라이언트에 제공하거나 외부 도메인 정보를 처리.
        - **포워드 프록시 서버:**
            - 내부 사용자(클라이언트)가 외부망에 접속 시 경유.
            - 내부망 사용자들의 익명성 확보 및 URL 필터링(차단, 허용), 캐싱 기능 제공.
            - 내부망 클라이언트의 **외부 웹사이트 접속 제어 및 로깅 기록.**
    - **DMZ 역할:**
        - 외부에서 요청을 받아 **웹서버**, **메일 서버**, **DNS 서버** 처리
        - 내부와 외부를 중계하고, 보안을 강화하는 완충 역할 수행.
        - **리버스 프록시 역할:**
            - DMZ의 웹 서버가 외부 요청을 받고 내부망의 WAS로 전달.
            - 외부망 클라이언트는 내부망 WAS와 직접적으로 통신하지 않음.
    - **내부망 서버:**
        - WAS(Web Application Server)
        - DBMS(Database Management System)
    - **내부망의 역할:**
        - WAS에서 비즈니스 로직 수행
        - DBMS에서 데이터 저장 및 관리

    - **포워드 프록시를 포함한 사내 접근 제어:**
        > DMZ에는 외부로 나가는 트래픽을 관리하는 포워드 프록시가 추가로 배치됩니다.
        - **내부 사용자(직원)** 가 외부 네트워크에 접속할 때, 내부망의 직접 통신을 차단하고 DMZ의 포워드 프록시 서버가 경유지 역할을 수행.
        - 포워드 프록시는 **웹 필터링**을 통해 특정 URL(예: 소셜 미디어, 비인가 사이트) 및 악성 웹사이트에 대한 접근을 차단.
        - **로깅(Log 기록):** 내부 사용자의 외부망 접속 트래픽을 기록하여 보안 및 감사에 활용.
    
    - **로드 밸런서:**
        - DMZ 내에서 로드밸런서를 운영하여, 외부 요청을 다수의 웹 서버로 분산 처리.
        - 웹 서버 간 부하를 줄이고, 가용성을 향상.
    - **보안 및 운영 이점:**
        > 1. 리버스 프록시 보안 강화
        >    - 외부에서 내부맘 서버(WAS, DBMS)에 직접 접근 불가능.
        >    - 외부 요청은 DMZ 내에서 한 번 정리된 후 내부망으로 전달됨.
        > 2. 포워드 프록시를 통한 사내 접근 통제
        >    - 내부 사용자의 외부 요청을 제어 및 관리.
        >    - URL 필터링 및 로깅을 통해 비인가 웹사이트 접근 차단.
        >    - 내부 IP 주소를 외부에 숨김으로써 프라이버시 보호.
        > 3. DMZ 로드분산 및 완충 역할
        >    - 외부의 공격이나 요청은 DMZ가 1차적으로 처리하게 되어 내부망 서버 로드를 줄이고 보안을 강화
        > 4. 내부망 방화벽 이중 보호
        >    - DMZ와 내부망 간 데이터는 엄격히 제한되어 보안성이 증가.
        > 5. 위험 요소 제거
        >    - 예를 들어 DMZ가 없을 경우, 내부 사용자와 외부 사용자의 직접적인 통신으로 인해 내부망 WAS/DBMS가 해킹당할 가능성이 높아짐.
        >    - DMZ 구성 및 포워드/리버스 프록시 역할로 이러한 리스크 최소화.


---

## 결론
프록시는 네트워크에서 클라이언트와 서버 간의 중개자 역할을 수행하여 **보안**, **성능**, **관리 효율성**을 높이는 데 기여한다.

- **포워드 프록시**는 **내부 클라이언트의 요청을 대신 처리**하고, 외부 네트워크 접속을 통제함으로써 **익명성 보호**와 **접근 제어** 역할을 수행한다. 이를 통해 내부망을 안전하게 유지하고 네트워크 자원을 효율적으로 관리.
- **리버스 프록시**는 **외부 요청을 내부 서버에 전달**하며, 내부 서버를 방어하고 **로드밸런싱**, **SSL 종료**, **보안 강화** 등 다양한 기능을 제공한다. 이로 인해 외부 트래픽을 효과적으로 처리함과 동시에 내부망 보호.
- **DMZ**는 내부망과 외부망 사이의 **중간 지대**로, **포워드 프록**시와 **리버스 프록시**의 역할을 모두 결합하여 최적의 보안 환경을 제공한다. DMZ가 구성되면, 외부 공격이나 내부 정보 유출의 위험을 최소화.

결론적으로, 포워드 프록시와 리버스 프록시는 DMZ를 기반으로 하는 네트워크 설계에서 각각 중요한 기능을 수행하며, 이를 통해 **안정적이고 안전한 IT 환경**을 운영할 수 있다.


<hr />