<hr />

# NAT(Network Address Translation)

## NAT란?
- NAT(Network Address Translation)는 **사설 네트워크(Private Network)**와 **공인 네트워크(Public Network)** 간의 IP 주소를 변환하는 기술이다.
- 내부 네트워크에 위치한 장치나 서버가 외부 네트워크(인터넷)와 통신할 수 있도록 **IP 주소 변환**을 중개한다.
- NAT를 사용하면 내부 네트워크 환경을 외부에 노출시키지 않고, 여러 장치가 하나의 **공인 IP**를 공유하여 인터넷을 사용할 수 있다.

- 구조
```
                   인터넷 (Public Network)
                           |
            -------------------------------------
            |             NAT 장치 (라우터)       |
            -------------------------------------
                 |                         |
  -----------------------------------      -----------------------------------
  | 내부 네트워크 (Private Network)  |      | 내부 네트워크 (Private Network)   |
  -----------------------------------      -----------------------------------
       192.168.1.2 (웹 서버)                     192.168.1.3 (DB 서버)
       192.168.1.4 (클라이언트)                  192.168.1.5 (사내 서버)

```

---

## 웹 서버를 NAT 뒤에 두는 이유

### 1. **보안 강화**
- NAT는 **실제 내부 네트워크의 구조와 IP 주소를 외부에 숨길 수 있다.**
  - 외부에서는 NAT를 통해 **공인 IP**만 보이기 때문에, 내부 네트워크를 직접 스캔하거나 침투하기 어렵다.
  - NAT 장치가 **방화벽** 기능을 함께 제공하면, 외부에서의 불필요한 요청을 차단할 수 있다.
- 웹 서버를 NAT 뒤에 두면, 서버가 직접 인터넷에 노출되지 않아 **공격과 침해 위험이 줄어든다.**

---

### 2. **사설 네트워크 사용**
- NAT는 **사설 IP(Private IP)**를 사용하는 내부 네트워크를 외부 인터넷과 연결할 수 있도록 해준다.
  - 사설 네트워크는 외부 인터넷에서는 직접 접근할 수 없는 네트워크로, 내부 자원을 안전하게 보호할 수 있다.
  - NAT가 요청을 변환하여 내부 네트워크(IP주소)를 외부 **공용 IP(Public IP)**로 매핑 및 전달한다.

#### 장점:
- 공인 IP 절약: 하나의 공인 IP 주소를 여러 내부 서버와 공유할 수 있다.
- 내부 리소스 보호: 외부에서 내부 네트워크 자원을 무분별하게 접근하는 것을 방지한다.

---

### 3. **로드 밸런싱**
- NAT는 **로드 밸런싱** 역할을 통해, 다수의 웹 서버로 트래픽을 효율적으로 분산할 수 있다.
  - 외부 요청은 NAT 장치의 공인 IP로 들어오고, 내부적으로 최적의 웹 서버에 전달된다.
- 이는 클라우드 환경에서 **수평적 확장성(Scaling)**을 지원하며, 트래픽 집중으로 인해 특정 서버가 과부하에 걸리는 것을 방지한다.

---

### 4. **접근 제어**
- NAT 뒤에 위치한 웹 서버로의 외부 접근은 NAT 장치에서 설정한 규칙에 따라 제한한다.
  - 예: HTTP(포트 80), HTTPS(포트 443)만 허용하고 나머지 포트는 차단.
- NAT와 방화벽을 결합하여, 허용된 요청만 내부 웹 서버로 전달되도록 제어할 수 있다.
  - SSH(22번 포트) 같은 민감한 포트는 외부에서 접근하지 못하도록 설정할 수 있다.

---

### 5. **네트워크 관리의 유연성**
- 네트워크 구조 변경 시에도 NAT를 사용하면 외부에서 볼 수 있는 **공인 IP 주소**는 그대로 유지되므로, 추가적인 변경이 필요하지 않다.
  - 내부 서버를 이동하거나, 새 서버를 추가하는 경우에도 NAT 장치의 설정만 수정하면 된다.
- 이를 통해 관리 복잡도가 줄어들고, 확장성이 높아진다.

---

### 6. **DDoS 공격 완화**
- NAT는 외부의 대규모 트래픽 공격(예: DDoS)으로부터 내부 네트워크와 서버를 보호할 수 있다.
  - 요청이 NAT 장치에서 먼저 차단되거나 필터링되므로, 웹 서버가 직접적인 공격을 받기 전에 보호막 역할을 한다.

---

### 7. **VPN 및 원격 접속**
- 내부 네트워크를 NAT 뒤에 구성하면, **VPN**을 통해 외부에서도 안전하게 내부 자원에 접근할 수 있다.
  - VPN 접속을 통해 인증받은 사용자만 NAT 뒤의 웹 서버나 다른 네트워크 자원에 접근할 수 있도록 설정할 수 있다.

---

## NAT의 유형
- **Static NAT (고정 NAT):**  
  - 하나의 공인 IP 주소를 특정 내부 IP 주소에 고정적으로 매핑한다.
  - 주로 내부에서 항상 같은 공인 IP로 접근해야 할 경우 사용된다.

- **Dynamic NAT (동적 NAT):**  
  - 여러 공인 IP 주소 중 하나를 동적으로 내부 IP 주소에 매핑한다.

- **PAT (Port Address Translation, 포트 주소 변환):**  
  - 하나의 공인 IP 주소를 여러 내부 장치에서 공유하며, 포트를 사용해 트래픽을 각각 구분한다.
  - 가장 일반적인 형태로, 웹 서버와 여러 장치에서 NAT를 공유할 때 주로 사용된다.

---

## NAT의 실제 활용 사례
1. **클라우드 환경(AWS, Azure 등):**  
   - 클라우드 서버는 기본적으로 사설 네트워크에서 운영되며, 공인 IP는 NAT 게이트웨이가 관리한다.
   - 외부에서 특정 서비스(IP/포트 접근)만 허용한다.

2. **기업 내부망:**  
   - 내부 데이터를 안전하게 유지하기 위해 사설 네트워크에서 서버를 관리하고, NAT를 통해 외부 접근을 제어한다.

3. **가정 네트워크:**  
   - WIFI 공유기를 통해 NAT가 가정 내 사설 네트워크(컴퓨터, 스마트폰 등)와 공인 인터넷을 연결한다.

---

### 결론
- NAT는 보안을 강화하고 네트워크 관리의 효율성을 높이며, 외부에서의 공격으로부터 서버를 보호하는 중요한 역할을 한다.
- 웹 서버를 NAT 뒤에 두면 서버의 직접적인 노출을 방지하고, 로드 밸런싱 및 VPN 설정을 통해 안정성과 확장성을 동시에 확보할 수 있다.

<hr />